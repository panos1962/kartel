.TH ERPOTA 1

.SH NAME
\fBerpota\fR \-\- ενημέρωση στοιχείων προσωπικού από την απομεμακρυσμένη
database \fIERPOTA\fR

.SH SYNOPSIS

.B erpota
[ OPTIONS ]

.SH DESCRIPTION

Το πρόγραμμα
.B erpota
ενημερώνει τα στοιχεία των εργαζομένων στην τοπική βάση δεδομένων
\fIerpota\fR
από την απομεμακρυσμένη βάση δεδομένων
\fIERPOTA\fR\.
Η ενημέρωση των στοιχείων δεν είναι προοδευτική, αλλά καθολική. Αυτό σημαίνει
ότι δεν ενημερώνουμε μόνο τα στοιχεία που έχουν εισαχθεί, διαγραφεί, ή έχουν
αλλάξει με οποιονδήποτε τρόπο, αλλά διαγράφουμε όλα τα παλαιά στοιχεία και
φορτώνουμε τα τρέχοντα. Πράγματι, η απομεμακρυσμένη βάση δεδομέναν \fIERPOTA\fR
είναι δομημένη με τέτοιον τρόπο που δεν παρέχει κάποιον ασφαλή τρόπο
προοδευτικής ενημέρωσης των στοιχείων. Για τους λόγους αυτούς, η τοπική βάση
δεδομένων έχει δύο εκδόσεις, τουτέστιν δύο δίδυμες βάσεις δεδομένων, τις
\fIerpota1\fR
και
\fIerpota2\fR.
Οι βάσεις αυτές ενημερώνονται εκ περιτροπής και η τρέχουσα έκδοση της τοπικής
βάσης δεδομένων
\fIerpota\fR
καταγράφεται στο αρχείο
\fIerpota12\fR
στο directory
\fIlib\fR
της εφαρμογής
\fIkartel\fR\.

Οι πίνακες που ενημερώνονται είναι ο πίνακας των εργαζομένων (\fIipalilos\fR)
και ο πίνακας μεταβολών στοιχείων υπαλλήλων (\fImetavoli\fR).
Επίσης ενημερώνεται, μέσω των μεταβολών, ο πίνακας υπηρεσιών (\fIipiresia\fR).
Σημειωτέον ότι από τον πίνακα των υπαλλήλων ενημερώνονται μόνο
τα πεδία που είναι απαραίτητα για τις ανάγκες τής εφαρμογής. Το ίδιο ισχύει και
για τους υπόλοιπους πίνακες, π.χ. μεταβολές που έχουν λήξει πριν την ημερομηνία
έναρξης της εφαρμογής, δεν παραλαμβάνονται από την απομεμακρυσμένη βάση
δεδομένων, όπως επίσης δεν παραλαμβάνονται όλα τα είδη μεταβολών αλλά μόνο αυτά
που έχουν σημασία για την εφαρμογή, π.χ. οραγνική μονάδα, ωράριο εργασίας,
αριθμός κάρτας κλπ.

.SH OPTIONS

.TP
.BR \-i ", " \-\-ipalilos\fR=\fByes\fR/\fBno\fR
By default το πρόγραμμα δεν ενημερώνει κανέναν από τους επίμαχους πίνακες. Η
option \fBipalilos\fR δείχνει αν θα ενημερωθεί ο πίνακας των υπαλλήλων ή όχι.

.TP
.BR \-m ", " \-\-metavoli\fR=\fByes\fR/\fBno\fR
Η option \fImetavoli\fR είναι παρόμοια με την option \fIipalilos\fR, αλλά αφορά
τον πίνακα των μεταβολών.

.TP
.BR \-A ", " \-\-all\fR
Με την option \fIall\fR τίθενται όλες οι προηγούμενες options, πράγμα που
σημαίνει ότι θα ενημερωθούν όλοι οι πίνακες της τοπικής βάσης δεδομένων
\fIerpota\fR.

.TP
.BR \-k " " \fR{\fB0\fR|\fB1\fR}\fB ", " \-\-katastasi\fR={\fB0\fR|\fB1\fR}
Με την option \fBkatastasi\fR μπορούμε να περιορίσουμε την ενημέρωση της τοπικής
βάσης δεδομένων μόνο στους ενεργούς υπαλλήλους δίνοντας ως όρισμα την
τιμή\~\fB1\fR, ενώ με όρισμα\~\fB0\fR ενημερώνουμε όλους τους υπαλλήλους,
ενεργούς και ανενεργούς.
By default ενημερώνονται όλοι οι υπάλληλοι,
ανεξαρτήτως αν πρόκειται για ενεργούς
ή ανενεργούς υπαλλήλους.

.TP
.BR \-\-file-copy-dir\fR
Το πρόγραμμα δίνει τη δυνατότητα αποθήκευσης των δεδομένων που λαμβάνει
από την απομεμακρυσμένη βάση δεδομένων \fBERPOTA\fR, σε αρχεία του local
file system. Τα ονόματα των εν λόγω αρχείων καθορίζονται με τις options
\fBipalilos-file\fR και \fBmetavoli-file\fR για τους
πίνακες \fIipalilos\fR και \fImetavoli\fR αντίστοιχα,
ενώ με την option \fBfile-copy-dir\fR καθορίζεται το directory αποθήκευσης
(ή εύρεσης) των εν λόγω αρχείων.
Στο σημείο αυτό είναι σημαντικό να τονίσουμε ότι η ενημέρωση της τοπικής βάσης
δεδομένων \fIerpota\fR μπορεί να γίνει και από τέτοιου είδους τοπικά αρχεία,
χωρίς να
χρησιμοποιηθεί η απομεμακρυσμένη βάση δεδομένων \fIERPOTA\fR κατά τη στιγμή τής
ενημέρωσης, επομένως
η ενημέρωση μπορεί να γίνει και σε δύο φάσεις· στην πρώτη φάση αποθηκεύουμε τα
δεδομένα σε αρχεία, χωρίς να ενημερώσουμε παράλληλα την τοπική βάση δεδομένων,
ενώ στη δεύτερη φάση ενημερώνουμε την τοπική βάση δεδομένων από τα εν λόγω
αρχεία.

.TP
.BR \-\-keep-file-copy\fR=\fByes\fR/\fBno\fR
Αν τεθεί η option \fBkeep-file-copy\fR, τότε παράλληλα με την ενημέρωση από την
απομεμακρυσμένη βάση δεδομένων \fIERPOTA\fR, θα κρατηθούν τα δεδομένα και σε
files για τους πίνακες για τους οποίους έχουμε καθορίσει ονόματα αρχείων.
Το ίδιο ισχύει και στην περίπτωση κατά την οποία δεν έχει καθοριστεί ενημέρωση
τής τοπικής βάσης δεδομένων, δηλαδή ακόμη και αν δεν έχει δοθεί η option
\fBdbload\fR.

.TP
.BR \-\-ipalilos-file\fR=\fIfilename\fR
.BR \-\-metavoli-file\fR=\fIfilename\fR
Με τις options \fBipalilios-file\fR και \fBmetavoli-file\fR
καθορίζουμε τα ονόματα των αρχείων στα οποία θα κρατηθούν (ή από τα οποία θα
διαβαστούν) τα στοιχεία των αντίστοιχων πινάκων. Για τους πίνακες για τους
οποίους δεν καθορίζεται αντίστοιχο όνομα αρχείου, δεν θα κρατηθούν δεδομένα στο
τοπικό file system.

.TP
.BR \-v ", " \-\-verbose\fR
.BR \-q ", " \-\-quiet\fR
.BR \-s ", " \-\-silent\fR
Με τις options \fIverbose\fR, \fBquiet\fR και \fBsilent\fR
καθορίζουμε αν το πρόγραμμα θα είναι «ομιλητικό»
κατά τη λειτουργία του, ή θα παραμένει «σιωπηλό».
Πράγματι, by default το πρόγραμμα
τυπώνει στην οθόνη του control terminal μηνύματα προόδου των εργασιών που
επιτελεί. Αν δεν επιθυμούμε να λαμβάνουμε τέτοιου είδους μηνύματα, δίνουμε την
option \fBquiet\fR, ή την option \fBsilent\fR (οι δύο options είναι ταυτόσημες).

.TP
.BR \-n ", " \-\-nullwarn\fR=\fByes\fR/\fBno\fR
Αν τεθεί η option \fBnullwarn\fR, τότε το πρόγραμμα μάς ενημερώνει για null
τιμές πεδίων που είναι «ύποπτες», π.χ. null ΑΦΜ υπαλλήλου, null αρχκή ημερομηνία
εργασιακής επαφής με τον οργανισμό κλπ.
Αν οι συγκεκριμένες παθογένειες είναι εν γνώσει μας και δεν επιθυμούμε να
βλέπουμε ξανά και ξανά τα σχετικά μηνύματα, τότε μπορούμε να θέσουμε false την
τιμή τής option \fBnullwarn\fR.

.TP
.BR \-E ", " \-\-erpotadbcf\fR=\fIfilename\fR
Για να υπάρξει επικοινωνία με την απομεμακρυσμένη βάση δεδομένων
\fRERPOTA\fR, θα πρέπει το πρόγραμμα να γνωρίζει διάφορες παραμέτρους,
credentials, tokens κλπ, π.χ. κάποιο όνομα χρήστη, κάποιον κωδικό, κάποιο
service id κοκ. Όλες αυτές οι παράμετροι πρέπει να είναι καταγεγραμμένες σε
configuration file το οποίο by default είναι το file \fBerpotadb.cf\R στο
directory \fBconf\fR, κάτω από το directory \fBlib\fR τής εφαρμογής. Αν για
οποιοδήποτε λόγο το configuration file έχει διαφορετικό όνομα, ή βρίσκεται σε
άλλο directory, τότε καθορίζουμε το pathname του εν λόγω αρχείου με την option
\fBerpotadbcf\fR.

.TP
.BR \-K ", " \-\-karteldbcf\fR=\fIfilename\fR
Αντίστοιχο με το configuration file \fBerpotadb.cf\fR που αφορά στην επικοινωνία
τού προγράμματος
με την απομεμακρυσμένη βάση δεδομένων \fIERPOTA\fR, είναι το configuration file
\fBkarteldb.cf\fR που αφορά στην επικοινωνία τού προγράμματος με την τοπική βάση
δεδομένων \fBerpota\fR. Αν το εν λόγω configuration file έχει διαφορετικό όνομα,
ή δεν βρίσκεται στο directory \fBconf\fR, κάτω από το \fBlib\fR τής εφαρμογής,
τότε καθορίζουμε το pathname του εν λόγω αρχείου με την option \fBkarteldbcf\fR.

.TP
.BR \-\-print\fR
Με την option \fBprint\fR το πρόγραμμα εκτυπώνει τα δεδομένα που παραλαμβάνει
στο standard output. Τα δεδομένα που εκτυπώνονται αφορούν τους πίνακες που έχουν
καθοριστεί με τις options \fBipalilos\fR, \fBmetavoli\fR και
\fBall\fR, ενώ πριν από τα δεδομένα κάθε πίνακα εκτυπώνεται label της μορφής
\fB@\fItable_name\fB@\fR.

.TP
.BR \-\-dbload\fR
Με την option \fBdbload\fR το πρόγραμμα φορτώνει τα δεδομένα που παραλαμβάνει
στην τοπική βάση δεδομένων \fBerpota\fR. Ως γνωστόν, η τοπική βάση δεδομένων
\fBerpota\fR αποτελείται από δύο δίδυμες εκδόσεις εκ των οποίων η μια είναι
ενεργή και η άλλη είναι αυτή που πρόκειται να ενημερωθεί. Εφόσον η ενημέρωση
περαιωθεί χωρίς προβλήματα, η έκδοση που ενημερώθηκε καθίσταται ενεργή, ενώ η
άλλη έκδοση τίθεται σε αναμονή ενημέρωσης. Η ενημέρωση της τοπικής βάσης
δεδομένων δεν μπορεί να αφορά σε κάποιους από τους πίνακες της βάσης
\fBerpota\fR, αλλά είναι καθολική πράγμα που σημαίνει ότι ασχέτως με το αν έχουν
καθοριστεί συγκεκριμένοι μόνο πίνακες προς ενημέρωση, το πρόγραμμα ενημερώνει
όλους τους επίμαχους πίνακες.

.SH AUTHOR

Το πρόγραμμα σχεδιάστηκε και γράφτηκε το 2019, από τους Δώρα Καργάκη και Πάνο
Παπαδόπουλο, στα πλαίσια της εφαρμογής \fBkartel\fR που αφορά στον έλεγχο των
ωρών προσέλευσης και αποχώρησης των υπαλλήλων του Δήμου Θεσσαλονίκης σε σχέση με
το ωράριο, τις άδειες και άλλες παραμέτρους που διαμορφώνουν το χρονικό πλαίσιο
εργασίας των εργαζομένων.

.SH COPYRIGHT

Το \fBerpota\fR είναι πρόγραμμα ανοικτού κώδικα, ωστόσο τα πνευματικά δικαιώματα
ανήκουν στους προγραμματιστές που ανέπτυξαν και συντηρούν το πρόγραμμα για
λογαριασμό του Δήμου Θεσσαλονίκης.

.SH NOTES

Η απομεμακρυσμένη βάση δεδομένων \fIERPOTA\fR είναι ORACLE database, ενώ η
τοπική βάση δεδομένων \fIerpota\fR είναι MySQL/MariaDB database.

.SH SEE ALSO

kartel(1), karteld(1), erpotadbcf(5), karteldbcf(5)
